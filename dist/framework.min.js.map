{"version":3,"sources":["dist/framework.js"],"names":["module","angular","factory","Event","e","element","documentNode","document","documentElement","body","parentNode","scroll","x","window","pageXOffset","scrollLeft","y","pageYOffset","scrollTop","type","view","w","this","getWidth","h","getHeight","node","getNode","offset","offsetLeft","offsetTop","rect","getBoundingClientRect","page","getPage","relative","left","top","absolute","console","log","originalEvent","self","innerWidth","clientWidth","innerHeight","clientHeight","standardEvents","touchEvents","indexOf","t","event","touches","length","changedTouches","pageX","pageY","Events","onClick","scope","listeners","click","apply","onMouseDown","down","removeTouchEvents","onMouseMove","move","onMouseUp","up","onResize","resize","onTouchStart","removeStandardEvents","onTouchMove","onTouchEnd","key","callback","getElement","onAdd","standard","touch","windowElement","forEach","listener","onRemove","on","off","prototype","add","remove","directive","link","attributes","model","removeClass","offsetWidth","material","style","setTimeout","addClass","createElement","appendChild","events","$on","restrict","priority","app","templateUrl","transclude","message","$http","$templateCache","$compile","$parse","formatLabel","string","prepend","expression","splitted","split","formatted","shift","value","index","join","uniqueId","template","control","ngModel","required","form","title","placeholder","require","compile","pre","label","filter","min","optionLabel","options","number","source","field","replace","validate","format","precision","minLength","maxLength","max","Number","POSITIVE_INFINITY","focus","visible","getType","getClasses","$parent","control-focus","control-success","$valid","control-error","$invalid","$submitted","$touched","control-empty","$viewValue","getMessages","$error","$timeout","getter","numberPicker","setter","assign","Math","removeListeners","nodeRemove","nodeAdd","querySelectorAll","$filter","onFocus","$modelValue","$setViewValue","doBlur","onBlur","$formatters","push","$parsers","unshift","valid","undefined","String","toString","$setValidity","Hash","pool","get","Object","defineProperties","enumerable","writable","has","id","getId","item","hash","set","newItem","p","i","keys","oldItem","splice","addMany","items","removeMany","removeAll","each","forward","reverse","sort","c","d","a","b","backward","differs","updatePool","pools","Array","header","service","$location","redirect","path","msecs","doRedirect","$$lastRequestedPath","doRetry","State","isReady","idle","isBusy","isError","isErroring","isSuccess","isSuccessing","button","errors","enabled","busy","success","bind","DELAY","error","ready","errorMessage","submitClass","successing","errorring","labels","addons","defaults","extend","classes","disabled","$q","$window","Cookie","TIMEOUT","_set","name","days","expires","date","Date","setTime","getTime","toGMTString","cookie","cache","json","JSON","stringify","cookieName","ca","charAt","substring","parse","delete","checkCookie","elapsed","timeout","deferred","reject","resolve","interval","defer","promise","LocalStorage","isSupported","supported","localStorage","setItem","removeItem","storageEvent","clearTimeout","newValue","SessionStorage","sessionStorage","Vector","make","size","sqrt","normalize","l","incidence","atan2","distance","cross","difference","power","abs","towards","friction","copy","$controller","Utils","getTouch","previous","s","getRelativeTouch","point","getClosest","el","selector","matchesFn","parent","some","fn","parentElement","getClosestElement","target","throttle","func","wait","context","args","result","later","leading","getNow","now","remaining","arguments","trailing","where","array","query","found","compileController","html","data","contents","controller","$scope","$new","controllerAs","children","reverseSortOn","reducer","o","reducerSetter","slice","reducerAdder","downloadFile","content","download","createEvent","anchor","href","base64","downloadName","lastIndexOf","initEvent","dispatchEvent","open","blob","Blob","reader","FileReader","readAsDataURL","onloadend","serverDownload","uri","extension","input","action","method","enctype","submit","removeChild","lastTime","vendors","requestAnimationFrame","cancelAnimationFrame","currTime","timeToCall","reduce","defineProperty","TypeError","len","k","ua","navigator","userAgent","toLowerCase","safari","msie","chrome","mobile","toMd5","Md5","encode","getElementsByTagName"],"mappings":"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","file":"framework.min.js","sourcesContent":["/* global angular */\r\n\r\nvar module = angular.module('framework', ['ng', 'ngSanitize', 'ngMessages']);\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.factory('Events', [function() {\n\n        function Event(e, element) {\n            var documentNode = (document.documentElement || document.body.parentNode || document.body);\n            var scroll = {\n                x: window.pageXOffset || documentNode.scrollLeft,\n                y: window.pageYOffset || documentNode.scrollTop\n            };\n            if (e.type === 'resize') {\n                var view = {\n                    w: this.getWidth(),\n                    h: this.getHeight(),\n                };\n                this.view = view;\n            }\n            var node = getNode(element);\n            var offset = {\n                x: node.offsetLeft,\n                y: node.offsetTop,\n            };\n            var rect = node.getBoundingClientRect();\n            var page = this.getPage(e);\n            if (page) {\n                var relative = {\n                    x: page.x - scroll.x - rect.left,\n                    y: page.y - scroll.y - rect.top,\n                };\n                var absolute = {\n                    x: page.x - scroll.x,\n                    y: page.y - scroll.y,\n                };\n                this.relative = relative;\n                this.absolute = absolute;\n            }\n            if (this.type === 'resize') {\n                console.log(this.type);\n            }\n            this.originalEvent = e;\n            this.element = element;\n            this.node = node;\n            this.offset = offset;\n            this.rect = rect;\n            // console.log('Event', 'page', page, 'scroll', scroll, 'offset', offset, 'rect', rect, 'relative', relative, 'absolute', absolute);\n            // console.log('scroll.y', scroll.y, 'page.y', page.y, 'offset.y', offset.y, 'rect.top', rect.top);\n        }\n        Event.prototype = {\n            getPage: getPage,\n            getWidth: getWidth,\n            getHeight: getHeight,\n        };\n\n        function getWidth() {\n            if (self.innerWidth) {\n                return self.innerWidth;\n            }\n            if (document.documentElement && document.documentElement.clientWidth) {\n                return document.documentElement.clientWidth;\n            }\n            if (document.body) {\n                return document.body.clientWidth;\n            }\n        }\n\n        function getHeight() {\n            if (self.innerHeight) {\n                return self.innerHeight;\n            }\n            if (document.documentElement && document.documentElement.clientHeight) {\n                return document.documentElement.clientHeight;\n            }\n            if (document.body) {\n                return document.body.clientHeight;\n            }\n        }\n\n        function getPage(e) {\n            var standardEvents = ['click', 'mousedown', 'mouseup', 'mousemove', 'mouseover', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu'];\n            var touchEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel'];\n            var page = null;\n            if (touchEvents.indexOf(e.type) !== -1) {\n                var t = null;\n                var event = e.originalEvent ? e.originalEvent : e;\n                var touches = event.touches.length ? event.touches : event.changedTouches;\n                if (touches && touches.length) {\n                    t = touches[0];\n                }\n                if (t) {\n                    page = {\n                        x: t.pageX,\n                        y: t.pageY,\n                    };\n                }\n            } else if (standardEvents.indexOf(e.type) !== -1) {\n                page = {\n                    x: e.pageX,\n                    y: e.pageY,\n                };\n            }\n            this.type = e.type;\n            return page;\n        }\n\n        function Events(element) {\n            this.element = element;\n            this.listeners = {};\n            this.standardEvents = {\n                click: {\n                    key: 'click',\n                    callback: onClick\n                },\n                down: {\n                    key: 'mousedown',\n                    callback: onMouseDown\n                },\n                move: {\n                    key: 'mousemove',\n                    callback: onMouseMove\n                },\n                up: {\n                    key: 'mouseup',\n                    callback: onMouseUp\n                },\n                resize: {\n                    key: 'resize',\n                    callback: onResize\n                },\n            };\n            this.touchEvents = {\n                down: {\n                    key: 'touchstart',\n                    callback: onTouchStart\n                },\n                move: {\n                    key: 'touchmove',\n                    callback: onTouchMove\n                },\n                up: {\n                    key: 'touchend',\n                    callback: onTouchEnd\n                },\n            };\n\n            var scope = this;\n\n            function onClick(e) {\n                // console.log('onClick', e, scope);\n                var event = new Event(e, scope.element);\n                scope.listeners.click.apply(this, [event]);\n            }\n\n            function onMouseDown(e) {\n                // console.log('onMouseDown', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.down.apply(this, [event]);\n                scope.removeTouchEvents();\n            }\n\n            function onMouseMove(e) {\n                // console.log('onMouseMove', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.move.apply(this, [event]);\n            }\n\n            function onMouseUp(e) {\n                // console.log('onMouseUp', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.up.apply(this, [event]);\n            }\n\n            function onResize(e) {\n                console.log('onResize', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.resize.apply(this, [event]);\n            }\n\n            function onTouchStart(e) {\n                // console.log('onTouchStart', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.down.apply(this, [event]);\n                scope.removeStandardEvents();\n            }\n\n            function onTouchMove(e) {\n                // console.log('onTouchMove', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.move.apply(this, [event]);\n            }\n\n            function onTouchEnd(e) {\n                // console.log('onTouchEnd', e);\n                var event = new Event(e, scope.element);\n                scope.listeners.up.apply(this, [event]);\n            }\n        }\n        Events.prototype = {\n            add: onAdd,\n            remove: onRemove,\n            removeStandardEvents: removeStandardEvents,\n            removeTouchEvents: removeTouchEvents,\n        };\n        return Events;\n\n        function getNode(element) {\n            return element.length ? element[0] : element; // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element[0] : element;\n        }\n\n        function getElement(element) {\n            return element.length ? element : angular.element(element); // (element.length && (element[0] instanceOf Node || element[0] instanceOf HTMLElement)) ? element : angular.element(element);\n        }\n\n        function onAdd(listeners) {\n            var scope = this,\n                standard = this.standardEvents,\n                touch = this.touchEvents;\n            var element = getElement(this.element),\n                windowElement = angular.element(window);\n\n            angular.forEach(listeners, function(callback, key) {\n                if (scope.listeners[key]) {\n                    var listener = {};\n                    listener[key] = scope.listeners[key];\n                    onRemove(listener);\n                }\n                scope.listeners[key] = callback;\n                if (standard[key]) {\n                    if (key === 'resize') {\n                        windowElement.on(standard[key].key, standard[key].callback);\n                    } else {\n                        element.on(standard[key].key, standard[key].callback);\n                    }\n                }\n                if (touch[key]) {\n                    element.on(touch[key].key, touch[key].callback);\n                }\n            });\n            return scope;\n        }\n\n        function onRemove(listeners) {\n            var scope = this,\n                standard = this.standardEvents,\n                touch = this.touchEvents;\n            var element = getElement(this.element),\n                windowElement = angular.element(window);\n            angular.forEach(listeners, function(callback, key) {\n                if (standard[key]) {\n                    if (key === 'resize') {\n                        windowElement.off(standard[key].key, standard[key].callback);\n                    } else {\n                        element.off(standard[key].key, standard[key].callback);\n                    }\n                }\n                if (touch[key]) {\n                    element.off(touch[key].key, touch[key].callback);\n                }\n                scope.listeners[key] = null;\n            });\n            return scope;\n        }\n\n        function removeStandardEvents() {\n            var scope = this,\n                standard = scope.standardEvents,\n                touch = scope.touchEvents;\n            var element = getElement(scope.element);\n            element.off('mousedown', standard.down.callback);\n            element.off('mousemove', standard.move.callback);\n            element.off('mouseup', standard.up.callback);\n        }\n\n        function removeTouchEvents() {\n            var scope = this,\n                standard = scope.standardEvents,\n                touch = scope.touchEvents;\n            var element = getElement(scope.element);\n            element.off('touchstart', touch.down.callback);\n            element.off('touchmove', touch.move.callback);\n            element.off('touchend', touch.up.callback);\n        }\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.directive('ngClick', ['Events', function(Events) {\n        return {\n            restrict: 'A',\n            priority: 0,\n            link: link\n        };\n\n        function link(scope, element, attributes, model) {\n            element.addClass('material');\n            var material = document.createElement('material');\n            element[0].appendChild(material);\n\n            function onClick(e) {\n                element.removeClass('animate');\n                void element.offsetWidth;\n                // material.style.animationPlayState = \"paused\";\n                material.style.left = e.relative.x + 'px';\n                material.style.top = e.relative.y + 'px';\n                setTimeout(function() {\n                    element.addClass('animate');\n                    setTimeout(function() {\n                        element.removeClass('animate');\n                    }, 1000);\n                }, 10);\n            }\n\n            var listeners = {\n                click: onClick,\n            };\n            var events = new Events(element).add(listeners);\n\n            scope.$on('$destroy', function() {\n                events.remove(listeners);\n            });\n\n        }\n    }]);\n\n}());\n/* global angular, app, Autolinker */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('framework');\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.directive('controlMessages', [function() {\n        return {\n            restrict: 'E',\n            templateUrl: 'partials/control-messages',\n            transclude: {\n                'message': '?messageItems',\n            },\n            link: function(scope, element, attributes, model) {}\n        };\n    }]);\n\n    app.directive('control', ['$http', '$templateCache', '$compile', '$parse', function($http, $templateCache, $compile, $parse) {\n        function formatLabel(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n        var uniqueId = 0;\n        return {\n            restrict: 'A',\n            templateUrl: function(element, attributes) {\n                var template = 'partials/forms/control';\n                switch (attributes.control) {\n                    case 'select':\n                        template = 'partials/forms/control-select';\n                        break;\n                }\n                return template;\n            },\n            scope: {\n                ngModel: '=',\n                required: '=',\n                form: '@',\n                title: '@',\n                placeholder: '@',\n            },\n            require: 'ngModel',\n            /*\n            link: function(scope, element, attributes, model) {\n            },\n            */\n            compile: function(element, attributes) {\n                    return {\n                        pre: function(scope, element, attributes) {\n                            if (attributes.control === 'select') {\n                                var label = (attributes.label ? attributes.label : 'name');\n                                var key = (attributes.key ? attributes.key : 'id');\n                                var filter = (attributes.min ? ' | filter:gte(\\'' + key + '\\', ' + attributes.min + ')' : '');\n                                var optionLabel = formatLabel(label, 'item.', true);\n                                scope.options = attributes.number ?\n                                    'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter :\n                                    optionLabel + ' disable when item.disabled for item in ' + attributes.source + filter + ' track by item.' + key;\n                                console.log('control.compile.pre', scope.options);\n                            }\n                            var type = scope.type = attributes.control;\n                            var form = scope.form = scope.form || 'form';\n                            var title = scope.title = scope.title || 'untitled';\n                            var placeholder = scope.placeholder = scope.placeholder || title;\n                            var field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.format = attributes.format || null;\n                            scope.precision = attributes.precision || null;\n                            scope.validate = attributes.validate || attributes.control;\n                            scope.minLength = attributes.min || 0;\n                            scope.maxLength = attributes.max || Number.POSITIVE_INFINITY;\n                            scope.options = $parse(attributes.options)(scope) || {};\n                            scope.focus = false;\n                            scope.visible = false;\n                            scope.getType = function() {\n                                var type = 'text';\n                                switch (attributes.control) {\n                                    case 'password':\n                                        // var form = $parse(scope.form)(scope.$parent);\n                                        // var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                        type = scope.visible ? 'text' : 'password';\n                                        break;\n                                    default:\n                                        type = attributes.control;\n                                }\n                                // console.log('control.getType', type);\n                                return type;\n                            };\n                            scope.getClasses = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return {\n                                    'control-focus': scope.focus,\n                                    'control-success': field.$valid,\n                                    'control-error': field.$invalid && (form.$submitted || field.$touched),\n                                    'control-empty': !field.$viewValue\n                                };\n                            };\n                            scope.getMessages = function() {\n                                var form = $parse(scope.form)(scope.$parent);\n                                var field = $parse(scope.form + '.' + scope.field)(scope.$parent);\n                                return (form.$submitted || field.$touched) && field.$error;\n                            };\n                        },\n                        // post: function (scope, element, attributes) { }\n                    };\n                }\n                /*\n                compile: function(element, attributes) {\n                    element.removeAttr('my-dir'); \n                    element.attr('ng-hide', 'true');\n                    return function(scope) {\n                        $compile(element)(scope);\n                    };\n                },\n                */\n        };\n    }]);\n\n    app.directive('numberPicker', ['$parse', '$timeout', function($parse, $timeout) {\n        return {\n            restrict: 'A',\n            template: '<div class=\"input-group\">' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">-</button></span>' +\n                '   <div ng-transclude></div>' +\n                '   <span class=\"input-group-btn\"><button class=\"btn btn-outline-primary\" type=\"button\">+</button></span>' +\n                '</div>',\n            replace: true,\n            transclude: true,\n            link: function(scope, element, attributes, model) {\n                var node = element[0];\n                var nodeRemove = node.querySelectorAll('.input-group-btn > .btn')[0];\n                var nodeAdd = node.querySelectorAll('.input-group-btn > .btn')[1];\n\n                function onRemove(e) {\n                    var min = $parse(attributes.min)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.max(min, getter(scope) - 1));\n                    });\n                    // console.log('numberPicker.onRemove', min);\n                }\n\n                function onAdd(e) {\n                    var max = $parse(attributes.max)(scope);\n                    var getter = $parse(attributes.numberPicker);\n                    var setter = getter.assign;\n                    $timeout(function() {\n                        setter(scope, Math.min(max, getter(scope) + 1));\n                    });\n                    // console.log('numberPicker.onAdd', max);\n                }\n\n                function addListeners() {\n                    angular.element(nodeRemove).on('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).on('touchstart mousedown', onAdd);\n                }\n\n                function removeListeners() {\n                    angular.element(nodeRemove).off('touchstart mousedown', onRemove);\n                    angular.element(nodeAdd).off('touchstart mousedown', onAdd);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.directive('validate', ['$filter', function($filter) {\n        return {\n            require: 'ngModel',\n            link: function(scope, element, attributes, model) {\n                var type = attributes.validate;\n                var format = attributes.format || '';\n                var precision = attributes.precision || 2;\n                var focus = false;\n                // console.log('validate', type);\n                switch (type) {\n                    case 'date':\n                    case 'datetime':\n                    case 'datetime-local':\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('date')(value, format);\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'number':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    model.$setValidity('positive', value >= 0.01);\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                model.$setValidity('positive', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                    case 'anynumber':\n                        model.$parsers.unshift(function(value) {\n                            var valid = false;\n                            if (value !== undefined && value !== \"\") {\n                                valid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); // \n                                value = Number(value);\n                                model.$setValidity('number', valid);\n                                if (valid) {\n                                    if (attributes.min !== undefined) {\n                                        model.$setValidity('range', value >= Number(attributes.min));\n                                    }\n                                    if (attributes.max !== undefined) {\n                                        model.$setValidity('range', value <= Number(attributes.max));\n                                    }\n                                }\n                            } else {\n                                valid = true;\n                                value = Number(value);\n                                model.$setValidity('number', true);\n                                if (attributes.min !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                                if (attributes.max !== undefined) {\n                                    model.$setValidity('range', true);\n                                }\n                            }\n                            return value;\n                        });\n                        model.$formatters.push(function(value) {\n                            if (value || value === 0) {\n                                return $filter('number')(value, precision) + ' ' + format;\n                            } else {\n                                return null;\n                            }\n                        });\n                        break;\n                }\n\n                function onFocus() {\n                    focus = true;\n                    if (format) {\n                        element[0].value = model.$modelValue || null;\n                        if (!model.$modelValue) {\n                            model.$setViewValue(null);\n                        }\n                    }\n                }\n\n                function doBlur() {\n                    if (format && !model.$invalid) {\n                        switch (type) {\n                            case 'date':\n                            case 'datetime':\n                            case 'datetime-local':\n                                element[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n                                break;\n                            default:\n                                element[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n                                break;\n                        }\n                    }\n                }\n\n                function onBlur() {\n                    focus = false;\n                    doBlur();\n                }\n\n                function addListeners() {\n                    element.on('focus', onFocus);\n                    element.on('blur', onBlur);\n                }\n\n                function removeListeners() {\n                    element.off('focus', onFocus);\n                    element.off('blur', onBlur);\n                }\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n                addListeners();\n            }\n        };\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.factory('Hash', [function() {\n        var pools = {};\n\n        function Hash(key, pool) {\n            key = key || 'id';\n            pool = pool ? Hash.get(pool) : {};\n            Object.defineProperties(this, {\n                key: {\n                    value: key,\n                    enumerable: false,\n                    writable: false\n                },\n                pool: {\n                    value: pool,\n                    enumerable: false,\n                    writable: false\n                },\n                length: {\n                    value: 0,\n                    enumerable: false,\n                    writable: true\n                }\n            });\n        }\n        Hash.get = function(pool) {\n            return (pools[pool] = pools[pool] || {});\n        };\n        Hash.prototype = new Array;\n        Hash.prototype.has = has;\n        Hash.prototype.getId = getId;\n        Hash.prototype.get = get;\n        Hash.prototype.set = set;\n        Hash.prototype.add = add;\n        Hash.prototype.remove = remove;\n        Hash.prototype.each = each;\n        Hash.prototype.addMany = addMany;\n        Hash.prototype.removeMany = removeMany;\n        Hash.prototype.removeAll = removeAll;\n        Hash.prototype.forward = forward;\n        Hash.prototype.backward = backward;\n        Hash.prototype.differs = differs;\n        Hash.prototype.updatePool = updatePool;\n        return Hash;\n\n        function has(id) {\n            return this.pool[id] !== undefined;\n        }\n\n        function getId(id) {\n            return this.pool[id];\n        }\n\n        function get(item) {\n            var hash = this,\n                key = this.key;\n            return item ? hash.getId(item[key]) : null;\n        }\n\n        function set(item) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            pool[item[key]] = item;\n            hash.push(item);\n            return item;\n        }\n\n        function add(newItem) {\n            var hash = this;\n            var item = hash.get(newItem);\n            if (item) {\n                for (var i = 0, keys = Object.keys(newItem), p; i < keys.length; i++) {\n                    p = keys[i];\n                    item[p] = newItem[p];\n                }\n            } else {\n                item = hash.set(newItem);\n            }\n            return item;\n        }\n\n        function remove(oldItem) {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            var item = hash.get(oldItem);\n            if (item) {\n                var index = hash.indexOf(item);\n                if (index !== -1) {\n                    hash.splice(index, 1);\n                }\n                delete pool[item[key]];\n            }\n            return hash;\n        }\n\n        function addMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.add(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeMany(items) {\n            var hash = this;\n            if (!items) {\n                return hash;\n            }\n            var i = 0;\n            while (i < items.length) {\n                hash.remove(items[i]);\n                i++;\n            }\n            return hash;\n        }\n\n        function removeAll() {\n            var hash = this,\n                key = hash.key,\n                pool = hash.pool;\n            var i = 0,\n                t = hash.length,\n                item;\n            while (hash.length) {\n                item = hash.shift();\n                delete pool[item[key]];\n                i++;\n            }\n            return hash;\n        }\n\n        function each(callback) {\n            var hash = this;\n            if (callback) {\n                var i = 0;\n                while (i < hash.length) {\n                    callback(hash[i], i);\n                    i++;\n                }\n            }\n            return hash;\n        }\n\n        function forward(key, reverse) {\n            var hash = this;\n            key = (key || this.key);\n            hash.sort(function(c, d) {\n                var a = reverse ? d : c;\n                var b = reverse ? c : d;\n                return a[key] - b[key];\n            });\n            return hash;\n        }\n\n        function backward(key) {\n            return this.forward(key, true);\n        }\n\n        function differs(hash) {\n            if (hash.key !== this.key || hash.length !== this.length) {\n                return true;\n            } else {\n                var differs = false,\n                    i = 0,\n                    t = this.length,\n                    key = this.key;\n                while (differs && i < t) {\n                    differs = this[i][key] !== hash[i][key];\n                    i++;\n                }\n            }\n        }\n\n        function updatePool() {\n            var hash = this,\n                pool = this.pool,\n                key = this.key;\n            Object.keys(pool).forEach(function(key) {\n                delete pool[key];\n            });\n            angular.forEach(hash, function(item) {\n                pool[item[key]] = item;\n            });\n        }\n\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('framework');\r\n\r\n    app.directive('header', [function() {\r\n        return {\r\n            restrict: 'E',\r\n            templateUrl: 'partials/header',\r\n            transclude: {\r\n                'header': '?headerItems',\r\n            },\r\n            link: function(scope, element, attributes, model) {}\r\n        };\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.service('Router', ['$location', '$timeout', function($location, $timeout) {\n\n        var service = this;\n        service.redirect = redirect;\n        service.path = path;\n        service.apply = apply;\n\n        function redirect(path, msecs) {\n            function doRedirect() {\n                $location.$$lastRequestedPath = $location.path();\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRedirect();\n                }, msecs);\n            } else {\n                doRedirect();\n            }\n        }\n\n        function path(path, msecs) {\n            function doRetry() {\n                path = $location.$$lastRequestedPath || path;\n                $location.$$lastRequestedPath = null;\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                doRetry();\n            }\n        }\n\n        function apply(path, msecs) {\n            function doRetry() {\n                $location.path(path);\n            }\n            if (msecs) {\n                $timeout(function() {\n                    doRetry();\n                }, msecs);\n            } else {\n                $timeout(function() {\n                    doRetry();\n                });\n            }\n        }\n\n    }]);\n\n}());\n/* global angular */\r\n\r\n(function() {\r\n    \"use strict\";\r\n\r\n    var app = angular.module('framework');\r\n\r\n    app.factory('State', ['$timeout', function($timeout) {\r\n        var DELAY = 2000;\r\n\r\n        function State() {\r\n            this.isReady = false;\r\n            this.idle();\r\n        }\r\n        State.prototype = {\r\n            idle: idle,\r\n            busy: busy,\r\n            enabled: enabled,\r\n            error: error,\r\n            ready: ready,\r\n            success: success,\r\n            errorMessage: errorMessage,\r\n            submitClass: submitClass,\r\n            labels: labels,\r\n            classes: classes,\r\n            disabled: disabled\r\n        };\r\n        return State;\r\n\r\n        function idle() {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.button = null;\r\n            this.errors = [];\r\n        }\r\n\r\n        function enabled() {\r\n            return !this.isBusy && !this.isErroring && !this.isSuccessing;\r\n        }\r\n\r\n        function busy(key) {\r\n            if (!this.isBusy) {\r\n                this.isBusy = true;\r\n                this.isError = false;\r\n                this.isErroring = false;\r\n                this.isSuccess = false;\r\n                this.isSuccessing = false;\r\n                this.errors = [];\r\n                this.key = key;\r\n                // console.log('State.busy', this);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        function success() {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = true;\r\n            this.isSuccessing = true;\r\n            this.errors = [];\r\n            $timeout(function() {\r\n                this.isSuccessing = false;\r\n                this.key = null;\r\n            }.bind(this), DELAY);\r\n        }\r\n\r\n        function error(error) {\r\n            this.isBusy = false;\r\n            this.isError = true;\r\n            this.isErroring = true;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.errors.push(error);\r\n            $timeout(function() {\r\n                this.isErroring = false;\r\n                this.key = null;\r\n            }.bind(this), DELAY);\r\n        }\r\n\r\n        function ready() {\r\n            this.isReady = true;\r\n            this.success();\r\n        }\r\n\r\n        function errorMessage() {\r\n            return this.isError ? this.errors[this.errors.length - 1] : null;\r\n        }\r\n\r\n        function submitClass() {\r\n            return {\r\n                busy: this.isBusy,\r\n                ready: this.isReady,\r\n                successing: this.isSuccessing,\r\n                success: this.isSuccess,\r\n                errorring: this.isErroring,\r\n                error: this.isError,\r\n            };\r\n        }\r\n\r\n        function labels(key, addons) {\r\n            var scope = this;\r\n            var defaults = {\r\n                ready: 'submit',\r\n                busy: 'sending',\r\n                error: 'error',\r\n                success: 'success',\r\n            };\r\n            if (addons) {\r\n                angular.extend(defaults, addons);\r\n            }\r\n            var label = defaults.ready;\r\n            // console.log('labels', scope.key, key);\r\n            if (this.key === key) {\r\n                if (this.isBusy) {\r\n                    label = defaults.busy;\r\n                } else if (this.isSuccess) {\r\n                    label = defaults.success;\r\n                } else if (this.isError) {\r\n                    label = defaults.error;\r\n                }\r\n            }\r\n            return label;\r\n        }\r\n\r\n        function classes(key, addons) {\r\n            var scope = this,\r\n                classes = null;\r\n            // console.log('stateClass', scope.key, key);\r\n            if (this.key === key) {\r\n                classes = {\r\n                    ready: scope.isReady,\r\n                    busy: scope.isBusy,\r\n                    successing: scope.isSuccessing,\r\n                    success: scope.isSuccess,\r\n                    errorring: scope.isErroring,\r\n                    error: scope.isError,\r\n                };\r\n                if (addons) {\r\n                    angular.forEach(addons, function(value, key) {\r\n                        classes[value] = classes[key];\r\n                    });\r\n                }\r\n            }\r\n            // console.log('stateClass', classes);\r\n            return classes;\r\n        }\r\n\r\n        function disabled(key) {\r\n            // console.log('disabled', key, this.key);\r\n            return (this.key && this.key !== key);\r\n        }\r\n    }]);\r\n\r\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.factory('Cookie', ['$q', '$window', function($q, $window) {\n        function Cookie() {}\n        Cookie.TIMEOUT = 5 * 60 * 1000; // five minutes\n        Cookie._set = function(name, value, days) {\n            var expires;\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = '; expires=' + date.toGMTString();\n            } else {\n                expires = '';\n            }\n            $window.document.cookie = name + '=' + value + expires + '; path=/';\n        };\n        Cookie.set = function(name, value, days) {\n            try {\n                var cache = [];\n                var json = JSON.stringify(value, function(key, value) {\n                    if (key === 'pool') {\n                        return;\n                    }\n                    if (typeof value === 'object' && value !== null) {\n                        if (cache.indexOf(value) !== -1) {\n                            // Circular reference found, discard key\n                            return;\n                        }\n                        cache.push(value);\n                    }\n                    return value;\n                });\n                cache = null;\n                Cookie._set(name, json, days);\n            } catch (e) {\n                console.log('Cookie.set.error serializing', name, value, e);\n            }\n        };\n        Cookie.get = function(name) {\n            var cookieName = name + \"=\";\n            var ca = $window.document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length);\n                }\n                if (c.indexOf(cookieName) === 0) {\n                    var value = c.substring(cookieName.length, c.length);\n                    var model = null;\n                    try {\n                        model = JSON.parse(value);\n                    } catch (e) {\n                        console.log('Cookie.get.error parsing', key, e);\n                    }\n                    return model;\n                }\n            }\n            return null;\n        };\n        Cookie.delete = function(name) {\n            Cookie._set(name, \"\", -1);\n        };\n        Cookie.on = function(name) {\n            var deferred = $q.defer();\n            var i, interval = 1000,\n                elapsed = 0,\n                timeout = Cookie.TIMEOUT;\n\n            function checkCookie() {\n                if (elapsed > timeout) {\n                    deferred.reject('timeout');\n                } else {\n                    var c = Cookie.get(name);\n                    if (c) {\n                        deferred.resolve(c);\n                    } else {\n                        elapsed += interval;\n                        i = setTimeout(checkCookie, interval);\n                    }\n                }\n            }\n            checkCookie();\n            return deferred.promise;\n        };\n        return Cookie;\n    }]);\n\n    app.factory('LocalStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function LocalStorage() {}\n\n        function isLocalStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'localStorage' in $window && $window.localStorage !== null;\n                if (supported) {\n                    $window.localStorage.setItem('test', '1');\n                    $window.localStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        LocalStorage.isSupported = isLocalStorageSupported();\n        if (LocalStorage.isSupported) {\n            LocalStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.localStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('LocalStorage.set.error serializing', name, value, e);\n                }\n            };\n            LocalStorage.get = function(name) {\n                var value = null;\n                if ($window.localStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.localStorage[name]);\n                    } catch (e) {\n                        console.log('LocalStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            LocalStorage.delete = function(name) {\n                $window.localStorage.removeItem(name);\n            };\n            LocalStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('LocalStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key == name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('LocalStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('LocalStorage.unsupported switching to cookies');\n            LocalStorage.set = Cookie.set;\n            LocalStorage.get = Cookie.get;\n            LocalStorage.delete = Cookie.delete;\n            LocalStorage.on = Cookie.on;\n        }\n        return LocalStorage;\n    }]);\n\n    app.factory('SessionStorage', ['$q', '$window', 'Cookie', function($q, $window, Cookie) {\n        function SessionStorage() {}\n\n        function isSessionStorageSupported() {\n            var supported = false;\n            try {\n                supported = 'sessionStorage' in $window && $window.sessionStorage !== undefined;\n                if (supported) {\n                    $window.sessionStorage.setItem('test', '1');\n                    $window.sessionStorage.removeItem('test');\n                } else {\n                    supported = false;\n                }\n            } catch (e) {\n                supported = false;\n            }\n            return supported;\n        }\n        SessionStorage.isSupported = isSessionStorageSupported();\n        if (SessionStorage.isSupported) {\n            SessionStorage.set = function(name, value) {\n                try {\n                    var cache = [];\n                    var json = JSON.stringify(value, function(key, value) {\n                        if (key === 'pool') {\n                            return;\n                        }\n                        if (typeof value === 'object' && value !== null) {\n                            if (cache.indexOf(value) !== -1) {\n                                // Circular reference found, discard key\n                                return;\n                            }\n                            cache.push(value);\n                        }\n                        return value;\n                    });\n                    cache = null;\n                    $window.sessionStorage.setItem(name, json);\n                } catch (e) {\n                    console.log('SessionStorage.set.error serializing', name, value, e);\n                }\n            };\n            SessionStorage.get = function(name) {\n                var value = null;\n                if ($window.sessionStorage[name] !== undefined) {\n                    try {\n                        value = JSON.parse($window.sessionStorage[name]);\n                    } catch (e) {\n                        console.log('SessionStorage.get.error parsing', name, e);\n                    }\n                }\n                return value;\n            };\n            SessionStorage.delete = function(name) {\n                $window.sessionStorage.removeItem(name);\n            };\n            SessionStorage.on = function(name) {\n                var deferred = $q.defer();\n                var i, timeout = Cookie.TIMEOUT;\n\n                function storageEvent(e) {\n                    // console.log('SessionStorage.on', name, e);\n                    clearTimeout(i);\n                    if (e.originalEvent.key === name) {\n                        try {\n                            var value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n                            deferred.resolve(value);\n                        } catch (error) {\n                            console.log('SessionStorage.on.error parsing', name, error);\n                            deferred.reject('error parsing ' + name);\n                        }\n                    }\n                }\n                angular.element($window).on('storage', storageEvent);\n                i = setTimeout(function() {\n                    deferred.reject('timeout');\n                }, timeout);\n                return deferred.promise;\n            };\n        } else {\n            console.log('SessionStorage.unsupported switching to cookies');\n            SessionStorage.set = Cookie.set;\n            SessionStorage.get = Cookie.get;\n            SessionStorage.delete = Cookie.delete;\n            SessionStorage.on = Cookie.on;\n        }\n        return SessionStorage;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('framework');\n\n    app.factory('Vector', function() {\n        function Vector(x, y) {\n            this.x = x || 0;\n            this.y = y || 0;\n        }\n        Vector.make = function(a, b) {\n            return new Vector(b.x - a.x, b.y - a.y);\n        };\n        Vector.size = function(a) {\n            return Math.sqrt(a.x * a.x + a.y * a.y);\n        };\n        Vector.normalize = function(a) {\n            var l = Vector.size(a);\n            a.x /= l;\n            a.y /= l;\n            return a;\n        };\n        Vector.incidence = function(a, b) {\n            var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\n            // if (angle < 0) angle += 2 * Math.PI;\n            // angle = Math.min(angle, (Math.PI * 2 - angle));\n            return angle;\n        };\n        Vector.distance = function(a, b) {\n            return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\n        };\n        Vector.cross = function(a, b) {\n            return (a.x * b.y) - (a.y * b.x);\n        };\n        Vector.difference = function(a, b) {\n            return new Vector(a.x - b.x, a.y - b.y);\n        };\n        Vector.power = function(a, b) {\n            var x = Math.abs(b.x - a.x);\n            var y = Math.abs(b.y - a.y);\n            return (x + y) / 2;\n        };\n        Vector.prototype = {\n            size: function() {\n                return Vector.size(this);\n            },\n            normalize: function() {\n                return Vector.normalize(this);\n            },\n            incidence: function(b) {\n                return Vector.incidence(this, b);\n            },\n            cross: function(b) {\n                return Vector.cross(this, b);\n            },\n            distance: function(b) {\n                return Vector.distance(this, b);\n            },\n            difference: function(b) {\n                return Vector.difference(this, b);\n            },\n            power: function() {\n                return (Math.abs(this.x) + Math.abs(this.y)) / 2;\n            },\n            towards: function(b, friction) {\n                friction = friction || 0.125;\n                this.x += (b.x - this.x) * friction;\n                this.y += (b.y - this.y) * friction;\n                return this;\n            },\n            add: function(b) {\n                this.x += b.x;\n                this.y += b.y;\n                return this;\n            },\n            friction: function(b) {\n                this.x *= b;\n                this.y *= b;\n                return this;\n            },\n            copy: function(b) {\n                return new Vector(this.x, this.y);\n            },\n            toString: function() {\n                return '{' + this.x + ',' + this.y + '}';\n            },\n        };\n        return Vector;\n    });\n\n    app.factory('Utils', ['$compile', '$controller', 'Vector', function($compile, $controller, Vector) {\n        (function() {\n            // POLYFILL window.requestAnimationFrame\n            var lastTime = 0;\n            var vendors = ['ms', 'moz', 'webkit', 'o'];\n            for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n                window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n                window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] ||\n                    window[vendors[x] + 'CancelRequestAnimationFrame'];\n            }\n            if (!window.requestAnimationFrame) {\n                window.requestAnimationFrame = function(callback, element) {\n                    var currTime = new Date().getTime();\n                    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n                    var id = window.setTimeout(function() { callback(currTime + timeToCall); }, timeToCall);\n                    lastTime = currTime + timeToCall;\n                    return id;\n                };\n            }\n            if (!window.cancelAnimationFrame) {\n                window.cancelAnimationFrame = function(id) {\n                    clearTimeout(id);\n                };\n            }\n        }());\n        (function() {\n            // POLYFILL Array.prototype.reduce\n            // Production steps of ECMA-262, Edition 5, 15.4.4.21\n            // Reference: http://es5.github.io/#x15.4.4.21\n            // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\n            if (!Array.prototype.reduce) {\n                Object.defineProperty(Array.prototype, 'reduce', {\n                    value: function(callback) { // , initialvalue\n                        if (this === null) {\n                            throw new TypeError('Array.prototype.reduce called on null or undefined');\n                        }\n                        if (typeof callback !== 'function') {\n                            throw new TypeError(callback + ' is not a function');\n                        }\n                        var o = Object(this);\n                        var len = o.length >>> 0;\n                        var k = 0;\n                        var value;\n                        if (arguments.length == 2) {\n                            value = arguments[1];\n                        } else {\n                            while (k < len && !(k in o)) {\n                                k++;\n                            }\n                            if (k >= len) {\n                                throw new TypeError('Reduce of empty array with no initial value');\n                            }\n                            value = o[k++];\n                        }\n                        while (k < len) {\n                            if (k in o) {\n                                value = callback(value, o[k], k, o);\n                            }\n                            k++;\n                        }\n                        return value;\n                    }\n                });\n            }\n        }());\n        var _isTouch;\n        var getNow = Date.now || function() {\n            return new Date().getTime();\n        };\n        var ua = window.navigator.userAgent.toLowerCase();\n        var safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\n        var msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\n        var chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\n        var mobile = ua.indexOf('mobile') !== -1;\n        var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;\n        var isSafari = navigator.userAgent.toLowerCase().indexOf('safari') > -1;\n\n        function Utils() {}\n        Utils.reverseSortOn = reverseSortOn;\n        Utils.getTouch = getTouch;\n        Utils.getRelativeTouch = getRelativeTouch;\n        Utils.getClosest = getClosest;\n        Utils.getClosestElement = getClosestElement;\n        Utils.throttle = throttle;\n        Utils.where = where;\n        Utils.format = format;\n        Utils.compileController = compileController;\n        Utils.reducer = reducer;\n        Utils.reducerSetter = reducerSetter;\n        Utils.reducerAdder = reducerAdder;\n        Utils.downloadFile = downloadFile;\n        Utils.serverDownload = serverDownload;\n        Utils.toMd5 = function(string) {\n            return Md5.encode(string);\n        };\n        Utils.ua = {\n            safari: safari,\n            msie: msie,\n            chrome: chrome,\n            mobile: mobile,\n        };\n        angular.forEach(Utils.ua, function(value, key) {\n            if (value) {\n                angular.element(document.getElementsByTagName('body')).addClass(key);\n            }\n        });\n        return Utils;\n\n        function isTouch() {\n            if (!_isTouch) {\n                _isTouch = {\n                    value: ('ontouchstart' in window || 'onmsgesturechange' in window)\n                };\n            }\n            // console.log(_isTouch);\n            return _isTouch.value;\n        }\n\n        function getTouch(e, previous) {\n            var t = new Vector();\n            if (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {\n                var touch = null;\n                var event = e.originalEvent ? e.originalEvent : e;\n                var touches = event.touches.length ? event.touches : event.changedTouches;\n                if (touches && touches.length) {\n                    touch = touches[0];\n                }\n                if (touch) {\n                    t.x = touch.pageX;\n                    t.y = touch.pageY;\n                }\n            } else if (e.type === 'click' || e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave' || e.type === 'contextmenu') {\n                t.x = e.pageX;\n                t.y = e.pageY;\n            }\n            if (previous) {\n                t.s = Vector.difference(t, previous);\n            }\n            t.type = e.type;\n            return t;\n        }\n\n        function getRelativeTouch(node, point) {\n            var element = angular.element(node); // passing through jqlite for accepting both\n            node = element[0];\n            var rect = node.getBoundingClientRect();\n            // var e = new Vector(rect.left + node.scrollLeft, rect.top + node.scrollTop);\n            var e = new Vector(rect.left, rect.top);\n            return Vector.difference(point, e);\n        }\n\n        function getClosest(el, selector) {\n            var matchesFn, parent;\n            ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function(fn) {\n                if (typeof document.body[fn] == 'function') {\n                    matchesFn = fn;\n                    return true;\n                }\n                return false;\n            });\n            if (el[matchesFn](selector)) {\n                return el;\n            }\n            while (el !== null) {\n                parent = el.parentElement;\n                if (parent !== null && parent[matchesFn](selector)) {\n                    return parent;\n                }\n                el = parent;\n            }\n            return null;\n        }\n\n        function getClosestElement(el, target) {\n            var matchesFn, parent;\n            if (el === target) {\n                return el;\n            }\n            while (el !== null) {\n                parent = el.parentElement;\n                if (parent !== null && parent === target) {\n                    return parent;\n                }\n                el = parent;\n            }\n            return null;\n        }\n\n        function throttle(func, wait, options) {\n            // Returns a function, that, when invoked, will only be triggered at most once\n            // during a given window of time. Normally, the throttled function will run\n            // as much as it can, without ever going more than once per `wait` duration;\n            // but if you'd like to disable the execution on the leading edge, pass\n            // `{leading: false}`. To disable execution on the trailing edge, ditto.\n            var context, args, result;\n            var timeout = null;\n            var previous = 0;\n            if (!options) options = {};\n            var later = function() {\n                previous = options.leading === false ? 0 : getNow();\n                timeout = null;\n                result = func.apply(context, args);\n                if (!timeout) context = args = null;\n            };\n            return function() {\n                var now = getNow();\n                if (!previous && options.leading === false) previous = now;\n                var remaining = wait - (now - previous);\n                context = this;\n                args = arguments;\n                if (remaining <= 0 || remaining > wait) {\n                    if (timeout) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                    }\n                    previous = now;\n                    result = func.apply(context, args);\n                    if (!timeout) context = args = null;\n                } else if (!timeout && options.trailing !== false) {\n                    timeout = setTimeout(later, remaining);\n                }\n                return result;\n            };\n        }\n\n        function where(array, query) {\n            var found = null;\n            if (array) {\n                angular.forEach(array, function(item) {\n                    var has = true;\n                    angular.forEach(query, function(value, key) {\n                        has = has && item[key] === value;\n                    });\n                    if (has) {\n                        found = item;\n                    }\n                });\n            }\n            return found;\n        }\n\n        function compileController(scope, element, html, data) {\n            // console.log('Utils.compileController', element);\n            element.html(html);\n            var link = $compile(element.contents());\n            if (data.controller) {\n                var $scope = scope.$new();\n                angular.extend($scope, data);\n                var controller = $controller(data.controller, { $scope: $scope });\n                if (data.controllerAs) {\n                    scope[data.controllerAs] = controller;\n                }\n                element.data('$ngControllerController', controller);\n                element.children().data('$ngControllerController', controller);\n                scope = $scope;\n            }\n            link(scope);\n        }\n\n        function reverseSortOn(key) {\n            return function(a, b) {\n                if (a[key] < b[key]) {\n                    return 1;\n                }\n                if (a[key] > b[key]) {\n                    return -1;\n                }\n                // a must be equal to b\n                return 0;\n            };\n        }\n\n        function format(string, prepend, expression) {\n            string = string || '';\n            prepend = prepend || '';\n            var splitted = string.split(',');\n            if (splitted.length > 1) {\n                var formatted = splitted.shift();\n                angular.forEach(splitted, function(value, index) {\n                    if (expression) {\n                        formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n                    } else {\n                        formatted = formatted.split('{' + index + '}').join(prepend + value);\n                    }\n                });\n                if (expression) {\n                    return '\\'' + formatted + '\\'';\n                } else {\n                    return formatted;\n                }\n            } else {\n                return prepend + string;\n            }\n        }\n\n        function reducer(o, key) {\n            return o[key];\n        }\n\n        function reducerSetter(o, key, value) {\n            if (typeof key == 'string') {\n                return reducerSetter(o, key.split('.'), value);\n            } else if (key.length == 1 && value !== undefined) {\n                return (o[key[0]] = value);\n            } else if (key.length === 0) {\n                return o;\n            } else {\n                return reducerSetter(o[key[0]], key.slice(1), value);\n            }\n        }\n\n        function reducerAdder(o, key, value) {\n            if (typeof key == 'string') {\n                return reducerAdder(o, key.split('.'), value);\n            } else if (key.length == 1 && value !== undefined) {\n                return (o[key[0]] += value);\n            } else if (key.length === 0) {\n                return o;\n            } else {\n                return reducerAdder(o[key[0]], key.slice(1), value);\n            }\n        }\n\n        function downloadFile(content, name, type) {\n            type = type || 'application/octet-stream';\n            var base64 = null;\n            var blob = new Blob([content], { type: type });\n            var reader = new window.FileReader();\n            reader.readAsDataURL(blob);\n            reader.onloadend = function() {\n                base64 = reader.result;\n                download();\n            };\n\n            function download() {\n                // If in Chrome or Safari - download via virtual link click\n                // if (isChrome || isSafari) {\n                //Creating new link node.\n                if (document.createEvent) {\n                    var anchor = document.createElement('a');\n                    anchor.href = base64;\n                    if (anchor.download !== undefined) {\n                        //Set HTML5 download attribute. This will prevent file from opening if supported.\n                        var downloadName = name || base64.substring(base64.lastIndexOf('/') + 1, base64.length);\n                        anchor.download = downloadName;\n                    }\n                    //Dispatching click event.\n                    var event = document.createEvent('MouseEvents');\n                    event.initEvent('click', true, true);\n                    anchor.dispatchEvent(event);\n                    return true;\n                }\n                // }\n                // Force file download (whether supported by server).\n                var query = '?download';\n                window.open(base64.indexOf('?') > -1 ? base64 : base64 + query, '_self');\n            }\n\n            function __download() {\n                var supportsDownloadAttribute = 'download' in document.createElement('a');\n                if (supportsDownloadAttribute) {\n                    var anchor = document.createElement('a');\n                    anchor.href = 'data:attachment/text;base64,' + encodeURI(window.btoa(content));\n                    anchor.target = '_blank';\n                    anchor.download = name;\n                    //Dispatching click event.\n                    if (document.createEvent) {\n                        var event = document.createEvent('MouseEvents');\n                        event.initEvent('click', true, true);\n                        anchor.dispatchEvent(event);\n                        return true;\n                    }\n                } else if (window.Blob !== undefined && window.saveAs !== undefined) {\n                    var blob = new Blob([content], { type: type });\n                    saveAs(blob, filename);\n                } else {\n                    window.open('data:attachment/text;charset=utf-8,' + encodeURI(content));\n                }\n            }\n            /*\n            var headers = response.headers();\n            // console.log(response);\n            var blob = new Blob([response.data], { type: \"application/octet-stream\" }); // { type: headers['content-type'] });\n            var windowUrl = (window.URL || window.webkitURL);\n            var downloadUrl = windowUrl.createObjectURL(blob);\n            var anchor = document.createElement(\"a\");\n            anchor.href = downloadUrl;\n            var fileNamePattern = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n            anchor.download = fileNamePattern.exec(headers['content-disposition'])[1];\n            document.body.appendChild(anchor);\n            anchor.click();\n            windowUrl.revokeObjectURL(blob);\n            anchor.remove();\n            */\n            /*\n            //Dispatching click event.\n            if (document.createEvent) {\n                var e = document.createEvent('MouseEvents');\n                e.initEvent('click', true, true);\n                link.dispatchEvent(e);\n                return true;\n            }\n            */\n        }\n\n        function serverDownload(options) {\n            var defaults = {\n                uri: '/api/reports/download',\n                name: 'Filename',\n                extension: 'txt',\n                type: 'text/plain',\n                content: 'Hello!',\n            };\n            options = angular.extend(defaults, options);\n            var content = JSON.stringify(options); // unescape(encodeURIComponent(JSON.stringify(download)));\n            var form = document.createElement('form');\n            var input = document.createElement('input');\n            input.name = 'download';\n            input.value = content;\n            form.appendChild(input);\n            form.action = options.uri;\n            form.method = 'POST';\n            form.target = 'ProjectDownloads';\n            form.enctype = 'application/x-www-form-urlencoded';\n            // form.enctype = 'multipart/form-data';\n            // form.enctype = 'text/plain';\n            document.body.appendChild(form);\n            form.submit();\n            setTimeout(function() {\n                document.body.removeChild(form);\n            }, 100);\n            // angular.element(form).find('button')[0].click();\n            return Utils;\n        }\n    }]);\n\n}());"]}